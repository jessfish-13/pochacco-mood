<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Pochacco Focus üêæ</title>

<link href="https://fonts.googleapis.com/css2?family=Hubballi&display=swap" rel="stylesheet">

<style>
  body {
    margin: 0;
    font-family: 'Hubballi', sans-serif;
    background: linear-gradient(135deg, #e9fff2, #f4fff9);
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
  }

  .card {
    background: white;
    width: 360px;
    padding: 20px;
    border-radius: 22px;
    border: 3px solid #c9f2dc;
    box-shadow: 0 12px 30px rgba(0,0,0,0.08);
  }

  h1 {
    text-align: center;
    color: #4fbf90;
    margin: 0;
  }

  .sub {
    text-align: center;
    font-size: 13px;
    color: #7ac7a6;
    margin-bottom: 10px;
  }

  button, input, select {
    font-family: 'Hubballi', sans-serif;
  }

  input, select {
    width: 100%;
    padding: 8px;
    border-radius: 14px;
    border: 1px solid #bfead3;
    margin: 6px 0;
  }

  button {
    background: #a8e6c8;
    border: none;
    border-radius: 14px;
    padding: 8px;
    cursor: pointer;
  }

  button:hover {
    background: #8fd9b6;
  }

  .timer {
    text-align: center;
    margin: 12px 0;
  }

  .time {
    font-size: 32px;
    color: #4fbf90;
  }

  .subject {
    background: #eafff3;
    padding: 8px;
    border-radius: 14px;
    margin: 6px 0;
    text-align: center;
    cursor: pointer;
  }

  .task {
    background: #f2fff8;
    border-radius: 12px;
    padding: 8px;
    margin: 6px 0;
    display: flex;
    justify-content: space-between;
    align-items: center;
  }

  .date {
    font-size: 11px;
    color: #6fbf9c;
  }

  .peace {
    text-align: center;
    margin-top: 12px;
  }

  .paws {
    display: flex;
    justify-content: center;
    gap: 10px;
    margin-top: 6px;
  }

  .paw {
    width: 38px;
    height: 38px;
    background: #c9f2dc;
    border-radius: 50%;
    cursor: pointer;
    transition: transform 0.1s ease;
  }

  .paw:active {
    transform: scale(0.75);
  }

  .popup {
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0.2);
    display: none;
    justify-content: center;
    align-items: center;
  }

  .popup-box {
    background: white;
    padding: 16px;
    border-radius: 16px;
    width: 260px;
    border: 2px solid #c9f2dc;
  }
</style>
</head>

<body>
<div class="card" id="app"></div>

<div class="popup" id="popup">
  <div class="popup-box">
    <h3>Add Subject</h3>
    <input id="subjectName" placeholder="subject name üçÉ">
    <button style="width:100%;" onclick="createSubject()">add</button>
  </div>
</div>

<script>
let subjects = JSON.parse(localStorage.getItem("subjects")) || {};

let time = 1500;
let timer;
let sessions = 0;

function save() {
  localStorage.setItem("subjects", JSON.stringify(subjects));
}

function renderHome() {
  location.hash = "";
  const app = document.getElementById("app");
  app.innerHTML = `
    <h1>üêæ Pochacco Focus</h1>
    <div class="sub">focus. rest. squish.</div>

    <input placeholder="task name üçÉ">
    <input type="date">
    <button>add task</button>

    <div class="timer">
      <div>25 min focus</div>
      <div class="time" id="time">${formatTime()}</div>
      <button onclick="start()">start</button>
      <button onclick="reset()">reset</button>
      <div>sessions completed: ${sessions}</div>
    </div>

    <button onclick="openPopup()">‚ûï add subject</button>
    ${Object.keys(subjects).map(s => `
      <div class="subject" onclick="openSubject('${s}')">${s}</div>
    `).join("")}

    <select>
      <option>how do you feel?</option>
      <option>üòä good</option>
      <option>üò¥ tired</option>
      <option>ü•∫ low</option>
      <option>üòµ stressed</option>
    </select>

    <div class="peace">
      peace corner üåø
      <div class="paws">
        <div class="paw"></div>
        <div class="paw"></div>
        <div class="paw"></div>
      </div>
    </div>
  `;
}

function openPopup() {
  document.getElementById("popup").style.display = "flex";
}

function createSubject() {
  const name = document.getElementById("subjectName").value.trim();
  if (!name) return;
  subjects[name] = [];
  save();
  document.getElementById("subjectName").value = "";
  document.getElementById("popup").style.display = "none";
  renderHome();
}

function openSubject(name) {
  location.hash = name;
  const app = document.getElementById("app");
  app.innerHTML = `
    <h1>${name}</h1>
    <div class="sub">Upcoming</div>

    <input id="taskText" placeholder="task ‚ú®">
    <input type="date" id="taskDate">
    <button onclick="addTask('${name}')">add task</button>

    ${subjects[name].map((t,i)=>`
      <div class="task">
        <div>
          ${t.text}
          ${t.date ? `<div class="date">${t.date}</div>` : ""}
        </div>
        <button onclick="deleteTask('${name}',${i})">‚úñ</button>
      </div>
    `).join("")}

    <button style="width:100%;margin-top:8px;" onclick="renderHome()">‚Üê back</button>
  `;
}

function addTask(subject) {
  const text = document.getElementById("taskText").value;
  const date = document.getElementById("taskDate").value;
  if (!text) return;
  subjects[subject].push({ text, date });
  save();
  openSubject(subject);
}

function deleteTask(subject,i) {
  subjects[subject].splice(i,1);
  save();
  openSubject(subject);
}

function start() {
  if (timer) return;
  timer = setInterval(() => {
    time--;
    document.getElementById("time").textContent = formatTime();
    if (time === 0) {
      clearInterval(timer);
      timer = null;
      sessions++;
      time = 1500;
      renderHome();
    }
  }, 1000);
}

function reset() {
  clearInterval(timer);
  timer = null;
  time = 1500;
  renderHome();
}

function formatTime() {
  const m = Math.floor(time / 60);
  const s = time % 60;
  return `${m}:${s.toString().padStart(2,"0")}`;
}

renderHome();
</script>
</body>
</html>
